<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aarohi Electrical & Electronics</title>

<style>
html, body {
  height: 100%;
}

body {
  margin:0;
  font-family:system-ui;
  background:#f1f3f6;
  display:flex;
  flex-direction:column;
}

/* layout */
.main-content {
  flex: 1;
}

/* header */
header {
  background:#2874f0;
  color:#fff;
  padding:14px 20px;
  display:flex;
  align-items:center;
  gap:12px;
}

header img {
  width:40px;
  height:40px;
  border-radius:50%;
  object-fit:cover;
  background:#fff;
  padding:3px;
}

/* category grid */
.container {
  padding:20px;
}

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:16px;
}

.card {
  background:#fff;
  border-radius:8px;
  padding:12px;
  text-align:center;
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
  transition:transform .15s;
}

.card:hover {
  transform:translateY(-3px);
}

.card img {
  width:100%;
  height:120px;
  object-fit:contain;
}

.card h4 {
  margin:10px 0 0;
}

/* footer */
footer {
  background:#172337;
  color:#fff;
  padding:20px;
  font-size:14px;
}

footer a {
  color:#fff;
  display:block;
  text-decoration:none;
}
</style>
</head>

<body>

<!-- HEADER -->
<header>
  <img src="logo.jpg" alt="AEE Logo">
  <strong>Aarohi Electrical & Electronics</strong>
</header>

<div class="main-content">

  <!-- SEARCH BAR -->
  <div style="background:#fff;padding:12px 20px;position:relative;">
    <input
      type="text"
      id="searchInput"
      placeholder="Search products (bulb, fan, brand...)"
      style="width:100%;padding:10px;font-size:16px;border:1px solid #ccc;border-radius:6px;"
      oninput="searchProducts(this.value)"
    >

    <div id="searchResults"
      style="position:absolute;top:52px;left:20px;right:20px;background:#fff;
             border:1px solid #ddd;border-radius:6px;max-height:300px;
             overflow:auto;display:none;z-index:999;">
    </div>
  </div>

  <!-- CATEGORIES -->
  <div class="container">
    <h2>Shop by Category</h2>
    <div id="categories" class="grid">Loading…</div>
  </div>

</div>

<!-- FOOTER -->
<footer>
  <div style="max-width:1100px;margin:auto;display:flex;flex-wrap:wrap;justify-content:space-between;gap:20px;">
    <div>
      <strong>Aarohi Electrical & Electronics</strong><br>
      Shop No 5, Chahkalyan Nalapar,<br>
      Patna City – 800009, Bihar
    </div>

    <div>
      <a href="about.html">About Us</a>
      <a href="privacy.html">Privacy Policy</a>
      <a href="index.html">Home</a>
    </div>

    <div style="max-width:300px;">
      <small>
        Some links on this website may be affiliate links.
        We may earn a small commission at no extra cost to you.
      </small>
    </div>
  </div>

  <hr style="margin:20px 0;border-color:#444;">
  <div style="text-align:center;">
    © <span id="year"></span> Aarohi Electrical & Electronics. All rights reserved.
  </div>
</footer>

<script>
/* ========== CONFIG ========== */
const DATA_URL = "https://script.google.com/macros/s/AKfycbyJQF3Jy481wx3yJgC4hckNuaz9_NIKwVqladLzoZrUrs9sF6-sQmOo_M-L2uv-n9HHRA/exec";
const CACHE_KEY = "AEE_PRODUCTS_CACHE";
const CACHE_TIME = 5 * 60 * 1000;
/* ============================ */

const CATEGORY_IMAGES = {
  "Lighting": "https://res.cloudinary.com/dsnb0jvki/image/upload/v1768558056/lightings_qu4doh.jpg",
  "Fans": "https://res.cloudinary.com/dsnb0jvki/image/upload/v1768558056/fans_bxex8r.jpg",
  "Switches": "https://res.cloudinary.com/dsnb0jvki/image/upload/v1768558056/switches_ha26fn.jpg",
  "Wires": "https://res.cloudinary.com/dsnb0jvki/image/upload/v1768558056/wires_loxdz6.jpg",
  "Accessories": "https://res.cloudinary.com/dsnb0jvki/image/upload/v1768558210/ChatGPT_Image_Jan_16_2026_03_18_32_PM_j6jiab.png"
};

let ALL_PRODUCTS = [];

/* cache fetch */
async function getProducts() {
  const cached = localStorage.getItem(CACHE_KEY);
  const cachedTime = localStorage.getItem(CACHE_KEY+"_TIME");

  if (cached && cachedTime && Date.now() - cachedTime < CACHE_TIME) {
    return JSON.parse(cached);
  }

  const res = await fetch(DATA_URL);
  const data = await res.json();

  localStorage.setItem(CACHE_KEY, JSON.stringify(data));
  localStorage.setItem(CACHE_KEY+"_TIME", Date.now());

  return data;
}

/* load data */
getProducts().then(data => {
  ALL_PRODUCTS = data.filter(p => String(p.active).toLowerCase().trim() === "yes");

  const categories = [...new Set(
    ALL_PRODUCTS.map(p => p.category.trim())
  )];

  document.getElementById("categories").innerHTML =
    categories.map(cat => {
      const cleanCat = cat.trim();
      return `
        <div class="card" onclick="openCategory('${encodeURIComponent(cleanCat)}')">
          <img src="${CATEGORY_IMAGES[cleanCat] || CATEGORY_IMAGES['Accessories']}" loading="lazy">
          <h4>${cleanCat}</h4>
        </div>
      `;
    }).join("");
});

/* category nav */
function openCategory(cat) {
  location.href = `category.html?cat=${cat}`;
}

/* search */
function searchProducts(query) {
  const box = document.getElementById("searchResults");
  query = query.toLowerCase().trim();

  if (query.length < 2) {
    box.style.display = "none";
    return;
  }

  const matches = ALL_PRODUCTS.filter(p =>
    p.brand.toLowerCase().includes(query) ||
    p.model.toLowerCase().includes(query) ||
    p.category.toLowerCase().includes(query)
  ).slice(0, 10);

  box.innerHTML = matches.map(p => `
    <div style="padding:10px;border-bottom:1px solid #eee;cursor:pointer"
         onclick="location.href='product.html?id=${p.id}'">
      <strong>${p.brand} ${p.model}</strong><br>
      <small>${p.category} • ₹${p.price}</small>
    </div>
  `).join("");

  box.style.display = "block";
}

document.addEventListener("click", e => {
  if (!e.target.closest("#searchInput")) {
    document.getElementById("searchResults").style.display = "none";
  }
});

/* footer year */
document.getElementById("year").innerText = new Date().getFullYear();
</script>

</body>
</html>
